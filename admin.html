<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Panel</title>

<style>
body{
    margin:0;
    font-family:Poppins, sans-serif;
    background:linear-gradient(135deg,#140f2d,#1c1340,#0f0a25);
    color:white;
}
.container{
    max-width:1000px;
    margin:auto;
    padding:20px;
}
.card{
    background:#181828;
    border:1px solid #2a2a4a;
    border-radius:15px;
    padding:20px;
    margin-bottom:20px;
}
h1{text-align:center;}
input, textarea{
    width:100%;
    padding:10px;
    margin:6px 0;
    border-radius:10px;
    border:1px solid #00f7ff;
    background:#111;
    color:white;
}
textarea{
    resize:vertical;
}
button{
    padding:8px 15px;
    border:none;
    border-radius:8px;
    cursor:pointer;
    margin:5px 3px;
    font-weight:600;
}
.btn{
    background:linear-gradient(90deg,#00f7ff,#8a2be2);
    color:white;
}
.danger{
    background:#ff3b3b;
    color:white;
}
.status{
    font-weight:bold;
}
hr{
    border:1px solid #333;
}
</style>
</head>
<body>

<div class="container">

<h1>ðŸ›  ADMIN PANEL</h1>
<button onclick="window.location.href='https://gabut.mrjhonmc.web.id'">
â¬… Balik ke Store
</button>

<!-- TAMBAH PRODUK -->
<div class="card">
<h2>ðŸ“¦ Tambah Produk</h2>
<input id="name" placeholder="Nama Produk">
<textarea id="desc" rows="4" placeholder="Deskripsi (bisa Enter ke bawah)"></textarea>
<input id="price" type="number" placeholder="Harga">
<button class="btn" onclick="addProduct()">Tambah Produk</button>
</div>

<!-- DAFTAR PRODUK -->
<div class="card">
<h2>ðŸ“¦ Daftar Produk</h2>
<div id="productList"></div>
</div>

<!-- TRANSAKSI -->
<div class="card">
<h2>ðŸ§¾ Transaksi</h2>
<div id="transactionList"></div>
</div>

</div>

<script>

// PASSWORD
let pass = prompt("Masukkan Password Admin:");
if(pass !== "rataradev"){
    alert("Akses Ditolak!");
    window.location.href = "/";
}

let products = JSON.parse(localStorage.getItem("products")) || [];
let transactions = JSON.parse(localStorage.getItem("transactions")) || [];

function saveProducts(){
    localStorage.setItem("products", JSON.stringify(products));
}
function saveTransactions(){
    localStorage.setItem("transactions", JSON.stringify(transactions));
}

// =======================
// PRODUK
// =======================

function addProduct(){
    let name = document.getElementById("name").value.trim();
    let desc = document.getElementById("desc").value; // newline tetap tersimpan
    let price = parseInt(document.getElementById("price").value);

    if(!name || !desc || !price){
        alert("Isi semua data!");
        return;
    }

    products.push({name,desc,price});
    saveProducts();
    renderProducts();

    document.getElementById("name").value="";
    document.getElementById("desc").value="";
    document.getElementById("price").value="";
}

function saveEdit(i){
    let newName = document.getElementById("editName"+i).value;
    let newDesc = document.getElementById("editDesc"+i).value;
    let newPrice = parseInt(document.getElementById("editPrice"+i).value);

    if(!newName || !newDesc || !newPrice){
        alert("Data tidak boleh kosong!");
        return;
    }

    products[i] = {
        name:newName,
        desc:newDesc,
        price:newPrice
    };

    saveProducts();
    renderProducts();
}

function deleteProduct(i){
    if(confirm("Yakin hapus produk ini?")){
        products.splice(i,1);
        saveProducts();
        renderProducts();
    }
}

function renderProducts(){
    let html="";

    if(products.length===0){
        html="Belum ada produk.";
    } else {
        products.forEach((p,i)=>{
            html+=`
            <div style="margin-bottom:15px;">
                <input id="editName${i}" value="${p.name}">
                <textarea id="editDesc${i}" rows="4">${p.desc}</textarea>
                <input id="editPrice${i}" type="number" value="${p.price}">
                <button class="btn" onclick="saveEdit(${i})">Simpan</button>
                <button class="danger" onclick="deleteProduct(${i})">Hapus</button>
            </div>
            <hr>
            `;
        });
    }

    document.getElementById("productList").innerHTML = html;
}

// =======================
// TRANSAKSI
// =======================

function updateStatus(i,status){
    transactions[i].status = status;
    saveTransactions();
    renderTransactions();
}

function deleteTransaction(i){
    if(confirm("Yakin hapus transaksi ini?")){
        transactions.splice(i,1);
        saveTransactions();
        renderTransactions();
    }
}

function renderTransactions(){
    let html="";

    if(transactions.length===0){
        html="Belum ada transaksi.";
    } else {
        transactions.forEach((t,i)=>{

            let status = t.status || "ðŸŸ¡ Menunggu Admin";

            html+=`
            <div style="margin-bottom:15px;">
                ID: <b>${t.id}</b><br>
                Produk: ${t.produk}<br>
                Harga: Rp${t.harga.toLocaleString()}<br>
                Nama Mc: ${t.mc}<br>
                Nomor Wa: ${t.wa}<br>
                Tanggal: ${t.tanggal}
                <span class="status">${status}</span><br><br>

                <button onclick="updateStatus(${i},'ðŸŸ¢ Pesanan Selesai')">
                Selesai
                </button>

                <button onclick="updateStatus(${i},'ðŸŸ¡ Menunggu Admin')">
                Menunggu
                </button>

                <button class="danger" onclick="deleteTransaction(${i})">
                Hapus
                </button>
            </div>
            <hr>
            `;
        });
    }

    document.getElementById("transactionList").innerHTML = html;
}

// INIT
renderProducts();
renderTransactions();

</script>
    
</body>
</html>
